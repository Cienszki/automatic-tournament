(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{10549:(e,s,t)=>{"use strict";t.d(s,{Accordion:()=>c,AccordionContent:()=>m,AccordionItem:()=>d,AccordionTrigger:()=>o});var a=t(95155),r=t(12115),n=t(23478),i=t(79556),l=t(59434);let c=n.bL,d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.q7,{ref:s,className:(0,l.cn)("border-b",t),...r})});d.displayName="AccordionItem";let o=r.forwardRef((e,s)=>{let{className:t,children:r,...c}=e;return(0,a.jsx)(n.Y9,{className:"flex",children:(0,a.jsxs)(n.l9,{ref:s,className:(0,l.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...c,children:[r,(0,a.jsx)(i.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});o.displayName=n.l9.displayName;let m=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsx)(n.UC,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:(0,a.jsx)("div",{className:(0,l.cn)("pb-4 pt-0 p-4",t),children:r})})});m.displayName=n.UC.displayName},14636:(e,s,t)=>{"use strict";t.d(s,{AM:()=>l,Wv:()=>c,hl:()=>d});var a=t(95155),r=t(12115),n=t(20547),i=t(59434);let l=n.bL,c=n.l9,d=r.forwardRef((e,s)=>{let{className:t,align:r="center",sideOffset:l=4,...c}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsx)(n.UC,{ref:s,align:r,sideOffset:l,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...c})})});d.displayName=n.UC.displayName},26126:(e,s,t)=>{"use strict";t.d(s,{E:()=>l});var a=t(95155);t(12115);var r=t(74466),n=t(59434);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:t}),s),...r})}},44829:(e,s,t)=>{Promise.resolve().then(t.bind(t,77711))},66424:(e,s,t)=>{"use strict";t.d(s,{F:()=>l});var a=t(95155),r=t(12115),n=t(47655),i=t(59434);let l=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(n.bL,{ref:s,className:(0,i.cn)("relative overflow-hidden",t),...l,children:[(0,a.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(c,{}),(0,a.jsx)(n.OK,{})]})});l.displayName=n.bL.displayName;let c=r.forwardRef((e,s)=>{let{className:t,orientation:r="vertical",...l}=e;return(0,a.jsx)(n.VM,{ref:s,orientation:r,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...l,children:(0,a.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=n.VM.displayName},77711:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eq});var a=t(95155),r=t(12115),n=t(59576),i=t(79323),l=t(30285),c=t(50172),d=t(17104),o=t(45731),m=t(66695),u=t(62523),h=t(85057),x=t(14636),p=t(85511),f=t(21887),j=t(10518),v=t(51920),g=t(64868),N=t(77223),b=t(28044),y=t(87481),w=t(59434),S=t(80479),A=t(34477);let C=(0,A.createServerReference)("002c8de62dd1b5b2e13a146df1f7c67a36ee7e695b",A.callServer,void 0,A.findSourceMapURL,"getGroups"),T=(0,A.createServerReference)("007bc35f7ff50f7251e211e7a90ad5ff49cb00b3a1",A.callServer,void 0,A.findSourceMapURL,"getMatches"),B=(0,A.createServerReference)("708c4bf04518f35f124bfc2656f9b1d06c5d5fe557",A.callServer,void 0,A.findSourceMapURL,"createGroup"),k=(0,A.createServerReference)("60663aabf4ce61d70f472a10bca3721497b7996784",A.callServer,void 0,A.findSourceMapURL,"deleteGroup"),R=(0,A.createServerReference)("70db3a3e85cd4643396f30d00c58ccfc1e4e57045a",A.callServer,void 0,A.findSourceMapURL,"generateMatchesForGroup"),E=(0,A.createServerReference)("40d7a81604248e64c3a160f772c772b5bb849e13a8",A.callServer,void 0,A.findSourceMapURL,"deleteAllGroups");var M=t(77740),F=t(75074),D=t(54165);let I=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.uB,{ref:s,className:(0,w.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...r})});I.displayName=M.uB.displayName;let O=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,a.jsx)(F.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(M.uB.Input,{ref:s,className:(0,w.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...r})]})});O.displayName=M.uB.Input.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.uB.List,{ref:s,className:(0,w.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...r})}).displayName=M.uB.List.displayName;let _=r.forwardRef((e,s)=>(0,a.jsx)(M.uB.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));_.displayName=M.uB.Empty.displayName;let G=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.uB.Group,{ref:s,className:(0,w.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...r})});G.displayName=M.uB.Group.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.uB.Separator,{ref:s,className:(0,w.cn)("-mx-1 h-px bg-border",t),...r})}).displayName=M.uB.Separator.displayName;let P=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.uB.Item,{ref:s,className:(0,w.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...r})});P.displayName=M.uB.Item.displayName;var U=t(17649);let Z=U.bL,$=U.l9,L=U.ZL,z=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(U.hJ,{className:(0,w.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});z.displayName=U.hJ.displayName;let W=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)(L,{children:[(0,a.jsx)(z,{}),(0,a.jsx)(U.UC,{ref:s,className:(0,w.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});W.displayName=U.UC.displayName;let Y=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,w.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};Y.displayName="AlertDialogHeader";let V=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,w.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};V.displayName="AlertDialogFooter";let J=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(U.hE,{ref:s,className:(0,w.cn)("text-lg font-semibold",t),...r})});J.displayName=U.hE.displayName;let H=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(U.VY,{ref:s,className:(0,w.cn)("text-sm text-muted-foreground",t),...r})});H.displayName=U.VY.displayName;let q=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(U.rc,{ref:s,className:(0,w.cn)((0,l.r)(),t),...r})});q.displayName=U.rc.displayName;let X=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(U.ZD,{ref:s,className:(0,w.cn)((0,l.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});X.displayName=U.ZD.displayName;var K=t(83013);function Q(){let{toast:e}=(0,y.dj)(),{user:s}=(0,n.A)(),[t,i]=r.useState([]),[d,o]=r.useState([]),[A,M]=r.useState(""),[F,D]=r.useState(!1),[U,L]=r.useState([]),[z,Q]=r.useState([]),[ee,es]=r.useState(!0),[et,ea]=r.useState(!1),[er,en]=r.useState(!1),[ei,el]=r.useState(null),[ec,ed]=r.useState(),[eo,em]=r.useState("23"),[eu,eh]=r.useState("59"),[ex,ep]=r.useState(!1),ef=r.useMemo(()=>{if(!ec)return;let e=new Date(ec),s=parseInt(eo,10),t=parseInt(eu,10);return isNaN(s)||isNaN(t)||e.setHours(s,t,0,0),e},[ec,eo,eu]),ej=r.useCallback(async()=>{es(!0);try{let[e,s,t]=await Promise.all([(0,S.Z)(),C(),T()]);console.log("[StageManagementTab] fetchedTeams:",e),console.log("[StageManagementTab] fetchedGroups:",s);let a=new Set(s.flatMap(e=>Object.keys(e.standings)));i(e.filter(e=>"verified"===e.status&&!a.has(e.id))),L(s.sort((e,s)=>e.name.localeCompare(s.name))),Q(t)}catch(s){e({title:"Error fetching data",description:"Could not load required data.",variant:"destructive"})}finally{es(!1)}},[e]);r.useEffect(()=>{ej()},[ej]);let ev=async()=>{if(!s)return e({title:"Authentication Error",description:"Please sign in.",variant:"destructive"});if(!A||0===d.length){e({title:"Error",description:"Please provide a group name and select at least one team.",variant:"destructive"});return}D(!0);let t=await s.getIdToken(),a=await B(t,A,d);e({title:a.success?"Success!":"Creation Failed",description:a.message,variant:a.success?"default":"destructive"}),a.success&&(M(""),o([]),ej()),D(!1)},eg=async t=>{if(!s)return e({title:"Authentication Error",description:"Please sign in.",variant:"destructive"});ea(t);let a=await s.getIdToken(),r=await k(a,t);e({title:r.success?"Success!":"Deletion Failed",description:r.message,variant:r.success?"default":"destructive"}),r.success&&ej(),ea(!1)},eN=async t=>{if(!s)return e({title:"Authentication Error",description:"Please sign in.",variant:"destructive"});el(t);let a=await s.getIdToken(),r=await R(a,t,ef||null);e({title:r.success?"Success!":"Generation Failed",description:r.message,variant:r.success?"default":"destructive"}),r.success&&ej(),el(null)},eb=async()=>{if(!s)return e({title:"Authentication Error",description:"Please sign in.",variant:"destructive"});en(!0);let t=await s.getIdToken(),a=await E(t);e({title:a.success?"Success!":"Deletion Failed",description:a.message,variant:a.success?"default":"destructive"}),a.success&&ej(),en(!1)};return(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Group Stage Management"}),(0,a.jsx)(m.BT,{children:"Create new groups and generate their match schedules."})]}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold mb-2",children:"1. Create New Group"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Only verified teams that are not already in a group are available for selection."}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h.J,{htmlFor:"new-group-name",children:"Group Name"}),(0,a.jsx)(u.p,{id:"new-group-name",value:A,onChange:e=>M(e.target.value),placeholder:"e.g., Group A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(h.J,{children:["Select Teams (",t.length," available)"]}),(0,a.jsxs)(x.AM,{children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",role:"combobox",className:"w-full justify-between",disabled:0===t.length,children:[d.length>0?"".concat(d.length," team(s) selected"):"Select teams...",(0,a.jsx)(f.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(x.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,a.jsxs)(I,{children:[(0,a.jsx)(O,{placeholder:"Search teams..."}),(0,a.jsx)(_,{children:"No available teams found."}),(0,a.jsx)(G,{className:"max-h-60 overflow-y-auto",children:t.map(e=>(0,a.jsxs)(P,{onSelect:()=>{o(s=>s.includes(e.id)?s.filter(s=>s!==e.id):[...s,e.id])},children:[(0,a.jsx)(j.A,{className:(0,w.cn)("mr-2 h-4 w-4",d.includes(e.id)?"opacity-100":"opacity-0")}),e.name," (",e.tag,")"]},e.id))})]})})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsxs)(l.$,{onClick:ev,disabled:F||!A||0===d.length,className:"w-full",children:[F&&(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Group"]})})]})]}),(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold mb-2",children:"2. Generate Matches for Groups"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Set a universal deadline for all group stage matches (optional), then generate schedules for each group individually. This action is idempotent - it will only generate matches that don't already exist."}),(0,a.jsxs)("div",{className:"max-w-md mb-6",children:[(0,a.jsx)(h.J,{children:"Scheduling Deadline (Optional)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x.AM,{open:ex,onOpenChange:ep,children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:(0,w.cn)("flex-grow justify-start text-left font-normal",!ef&&"text-muted-foreground"),children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),ef?(0,K.GP)(ef,"PPP 'at' HH:mm"):(0,a.jsx)("span",{children:"Pick a date & time"})]})}),(0,a.jsxs)(x.hl,{className:"w-auto p-0",children:[(0,a.jsx)(p.V,{mode:"single",selected:ec,onSelect:ed,initialFocus:!0}),(0,a.jsx)("div",{className:"p-2 border-t border-border",children:(0,a.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>ep(!1),className:"w-full",children:"Done"})})]})]}),(0,a.jsx)(u.p,{type:"number",value:eo,onChange:e=>em(e.target.value),min:"0",max:"23",className:"w-16"}),(0,a.jsx)(u.p,{type:"number",value:eu,onChange:e=>eh(e.target.value),min:"0",max:"59",step:"1",className:"w-16"})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:ee?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(c.A,{className:"animate-spin"})}):0===U.length?(0,a.jsx)("p",{className:"text-muted-foreground",children:"No groups created yet."}):U.map(e=>{let s=Object.keys(e.standings),t=s.length*(s.length-1)/2,r=z.filter(s=>s.group_id===e.id).length,n=t===r;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.length," teams (",r,"/",t," matches)"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(l.$,{variant:"secondary",size:"sm",onClick:()=>eN(e.id),disabled:!!ei||et===e.id||er||n,children:[ei===e.id?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"}),n?"Generated":"Generate"]}),(0,a.jsxs)(Z,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10",disabled:!!ei||et===e.id||er,children:et===e.id?(0,a.jsx)(c.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(N.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(W,{children:[(0,a.jsxs)(Y,{children:[(0,a.jsxs)(J,{children:["Delete ",e.name,"?"]}),(0,a.jsxs)(H,{children:["This will remove the group and all of its ",r," scheduled matches. This action is irreversible."]})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(X,{children:"Cancel"}),(0,a.jsx)(q,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>eg(e.id),children:"Confirm Delete"})]})]})]})]})]},e.id)})}),U.length>0&&(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-destructive/30",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-destructive mb-2 flex items-center",children:[(0,a.jsx)(b.A,{className:"mr-2 h-5 w-5"}),"Danger Zone"]}),(0,a.jsxs)(Z,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"destructive",className:"w-full",disabled:er||!!ei||!!et,children:[er?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Delete All Groups & Matches"]})}),(0,a.jsxs)(W,{children:[(0,a.jsxs)(Y,{children:[(0,a.jsx)(J,{children:"Are you absolutely sure?"}),(0,a.jsxs)(H,{children:["This will delete all ",U.length," groups and all their associated matches. This action is final."]})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(X,{children:"Cancel"}),(0,a.jsx)(q,{className:"bg-destructive hover:bg-destructive/90",onClick:eb,children:"Yes, delete all"})]})]})]})]})]})]})]})}var ee=t(85127),es=t(59119),et=t(52333),ea=t(18763),er=t(8531),en=t(41684),ei=t(58127),el=t(9086);let ec=(0,A.createServerReference)("60dccfbdd60d2d86ff660c86101d0a4f7936de7bce",A.callServer,void 0,A.findSourceMapURL,"revertMatchToPending");function ed(e){let{isOpen:s,onClose:t,games:n,onDelete:i}=e,[c,d]=r.useState(null);return r.useEffect(()=>{s||d(null)},[s]),(0,a.jsx)(D.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(D.Cf,{children:[(0,a.jsxs)(D.c7,{children:[(0,a.jsx)(D.L3,{children:"Delete a Game"}),(0,a.jsx)(D.rr,{children:"Select a game to delete. This will block it from future sync attempts."})]}),(0,a.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:n.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"radio",id:e.id,name:"game",value:e.id,checked:c===e.id,onChange:()=>d(e.id)}),(0,a.jsx)("label",{htmlFor:e.id,children:e.name||e.id})]},e.id))}),(0,a.jsxs)(D.Es,{children:[(0,a.jsx)(l.$,{variant:"ghost",onClick:t,children:"Cancel"}),(0,a.jsx)(l.$,{variant:"destructive",onClick:()=>c&&i(c),disabled:!c,children:"Delete Selected Game"})]})]})})}var eo=t(66766),em=t(59409);function eu(e){var s,t;let{isOpen:n,onClose:i,match:c,onImportSuccess:d}=e,[o,m]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),[p,f]=(0,r.useState)(null),[j,v]=(0,r.useState)(""),[g,N]=(0,r.useState)(""),[b,y]=(0,r.useState)("1"),[w,S]=(0,r.useState)(!1),[A,C]=(0,r.useState)(null),T=(0,r.useRef)(null);r.useEffect(()=>{n||(m(null),x(null),f(null),v(""),N(""),y("1"),S(!1),C(null))},[n]);let B=async e=>{var s;x(null),f(null);let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(t){m(t);try{let e=await t.text(),s=JSON.parse(e);f(s)}catch(e){x("Invalid JSON file.")}}},k=async()=>{S(!0),C(null);try{if(!p||!j||!g||!c){C("Please provide all required information."),S(!1);return}let e=await fetch("/api/import-match",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({openDotaData:p,radiantTeam:j,direTeam:g,matchId:c.id,gameNumber:b})});if(!e.ok){let s=await e.json();throw Error(s.error||"Import failed.")}S(!1),d()}catch(e){C((null==e?void 0:e.message)||"Import failed."),S(!1)}},R=c?[{id:c.teamA.id,name:c.teamA.name},{id:c.teamB.id,name:c.teamB.name}]:[];return(0,a.jsx)(D.lG,{open:n,onOpenChange:i,children:(0,a.jsxs)(D.Cf,{children:[(0,a.jsxs)(D.c7,{children:[(0,a.jsx)(D.L3,{children:"Import Game Data"}),(0,a.jsxs)(D.rr,{children:["Import OpenDota JSON data for ",(null==c?void 0:null===(s=c.teamA)||void 0===s?void 0:s.name)||"TBD"," vs ",(null==c?void 0:null===(t=c.teamB)||void 0===t?void 0:t.name)||"TBD","."]})]}),(0,a.jsxs)("div",{className:"py-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block font-medium mb-1",children:"OpenDota Match JSON"}),(0,a.jsx)(u.p,{type:"file",accept:"application/json",onChange:B,ref:T}),h&&(0,a.jsx)("div",{className:"text-destructive text-sm mt-1",children:h}),p&&(0,a.jsxs)("div",{className:"text-green-700 text-sm mt-1",children:["File loaded: ",null==o?void 0:o.name]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",children:"Radiant Team"}),(0,a.jsxs)(em.l6,{value:j,onValueChange:v,children:[(0,a.jsx)(em.bq,{children:(0,a.jsx)(em.yv,{placeholder:"Select Radiant"})}),(0,a.jsx)(em.gC,{children:R.map(e=>(0,a.jsx)(em.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",children:"Dire Team"}),(0,a.jsxs)(em.l6,{value:g,onValueChange:N,children:[(0,a.jsx)(em.bq,{children:(0,a.jsx)(em.yv,{placeholder:"Select Dire"})}),(0,a.jsx)(em.gC,{children:R.map(e=>(0,a.jsx)(em.eb,{value:e.id,children:e.name},e.id))})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block font-medium mb-1",children:"Game Number"}),(0,a.jsxs)(em.l6,{value:b,onValueChange:y,children:[(0,a.jsx)(em.bq,{children:(0,a.jsx)(em.yv,{placeholder:"Select game number"})}),(0,a.jsx)(em.gC,{children:["1","2","3"].map(e=>(0,a.jsx)(em.eb,{value:e,children:e},e))})]})]}),A&&(0,a.jsx)("div",{className:"text-destructive text-sm",children:A}),(0,a.jsx)(l.$,{onClick:k,disabled:w||!p||!j||!g,className:"w-full",children:w?"Importing...":"Import Game Data"})]})]})})}function eh(){let{toast:e}=(0,y.dj)(),{user:s}=(0,n.A)(),[t,i]=r.useState([]),[d,o]=r.useState({}),[h,x]=r.useState(null),[p,f]=r.useState(null),[j,v]=r.useState(!1),[g,N]=r.useState(null),[b,w]=r.useState(!1),[S,A]=r.useState(null),[C,T]=r.useState([]),[B,k]=r.useState(!1);async function R(e){return e.game_ids&&0!==e.game_ids.length?e.game_ids.map(e=>({id:e.toString(),name:"Game ".concat(e)})):[]}let E=async e=>{A(e),w(!0),T(await R(e))},M=async t=>{if(S&&s){try{let a=await s.getIdToken(),r=await fetch("/api/admin/deleteGame",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({match:S,gameId:t})}),n=await r.json();e({title:n.success?"Game Deleted":"Delete Failed",description:n.message,variant:n.success?"default":"destructive"})}catch(s){e({title:"Delete Failed",description:"Could not delete the game. Please try again.",variant:"destructive"})}w(!1),A(null),T([]),i((await (0,el.Xe)()).sort((e,s)=>(e.group_id||"").localeCompare(s.group_id||"")))}},F=async()=>{if(!s){e({title:"Authentication Error",description:"You must be logged in to perform this action.",variant:"destructive"});return}k(!0);try{let t=await s.getIdToken(),a=await fetch("/api/admin/recalculateStandings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}),r=await a.json();r.success?e({title:"Success",description:"Group standings have been recalculated successfully!"}):e({title:"Error",description:r.message||"Failed to recalculate standings",variant:"destructive"})}catch(s){console.error("Error recalculating standings:",s),e({title:"Error",description:"An unexpected error occurred while recalculating standings.",variant:"destructive"})}finally{k(!1)}};r.useEffect(()=>{!async function(){i((await (0,el.Xe)()).sort((e,s)=>(e.group_id||"").localeCompare(s.group_id||"")))}()},[]);let D=(e,s,t)=>{o(a=>({...a,[e]:{...a[e],["A"===s?"teamAScore":"teamBScore"]:t}}))},I=async t=>{if(!s){e({title:"Authentication Error",description:"You must be logged in to perform this action.",variant:"destructive"});return}f(t);let a=await s.getIdToken(),r=await ec(a,t);e({title:r.success?"Success!":"Revert Failed",description:r.message,variant:r.success?"default":"destructive"}),r.success&&i(e=>e.map(e=>e.id===t?{...e,status:"scheduled",schedulingStatus:"unscheduled",teamA:{...e.teamA,score:0},teamB:{...e.teamB,score:0},game_ids:[]}:e)),f(null)},O=async s=>{let t=d[s.id];if(!t||""===t.teamAScore||""===t.teamBScore){e({title:"Error",description:"Please enter scores for both teams.",variant:"destructive"});return}let a=parseInt(t.teamAScore,10),r=parseInt(t.teamBScore,10);try{var n,l;await (0,el.Is)(s.id,a,r),i(e=>e.map(e=>e.id===s.id?{...e,teamA:{...e.teamA,score:a},teamB:{...e.teamB,score:r},status:"completed"}:e)),e({title:"Success!",description:"Scores for ".concat((null===(n=s.teamA)||void 0===n?void 0:n.name)||"TBD"," vs ").concat((null===(l=s.teamB)||void 0===l?void 0:l.name)||"TBD"," have been saved.")}),x(null)}catch(s){console.error("Failed to save scores:",s),e({title:"Error",description:"Could not save the scores. Please try again.",variant:"destructive"})}},_=e=>{x(e.id),o(s=>{var t,a,r,n;return{...s,[e.id]:{teamAScore:(null===(a=e.teamA)||void 0===a?void 0:null===(t=a.score)||void 0===t?void 0:t.toString())||"",teamBScore:(null===(n=e.teamB)||void 0===n?void 0:null===(r=n.score)||void 0===r?void 0:r.toString())||""}}})},G=e=>{N(e),v(!0)},P=e=>{var s,t,r,n;let i=h===e.id,o=p===e.id,m=d[e.id]||{teamAScore:"",teamBScore:""};return(0,a.jsxs)(ee.Hj,{className:i?"bg-muted/50":"",children:[(0,a.jsx)(ee.nA,{className:"font-medium",children:e.group_id||"N/A"}),(0,a.jsx)(ee.nA,{children:e.teamA?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eo.default,{src:e.teamA.logoUrl,alt:e.teamA.name,width:24,height:24,className:"rounded-sm"}),(0,a.jsx)("span",{children:e.teamA.name})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"Team TBD"})}),(0,a.jsx)(ee.nA,{children:e.teamB?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eo.default,{src:e.teamB.logoUrl,alt:e.teamB.name,width:24,height:24,className:"rounded-sm"}),(0,a.jsx)("span",{children:e.teamB.name})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"Team TBD"})}),(0,a.jsx)(ee.nA,{children:(0,a.jsx)("div",{className:"flex items-center justify-center space-x-2",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.p,{type:"number",className:"w-16 h-8 text-center",placeholder:"0",value:m.teamAScore,onChange:s=>D(e.id,"A",s.target.value),disabled:!e.teamA||!e.teamB}),(0,a.jsx)("span",{children:"-"}),(0,a.jsx)(u.p,{type:"number",className:"w-16 h-8 text-center",placeholder:"0",value:m.teamBScore,onChange:s=>D(e.id,"B",s.target.value),disabled:!e.teamA||!e.teamB})]}):(0,a.jsxs)("span",{children:[null!==(r=null===(s=e.teamA)||void 0===s?void 0:s.score)&&void 0!==r?r:"-"," : ",null!==(n=null===(t=e.teamB)||void 0===t?void 0:t.score)&&void 0!==n?n:"-"]})})}),(0,a.jsx)(ee.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)(l.$,{size:"sm",variant:"destructive",onClick:()=>E(e),disabled:!e.game_ids||0===e.game_ids.length,children:"Delete Game"}),i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.$,{size:"sm",onClick:()=>O(e),disabled:!e.teamA||!e.teamB,children:[(0,a.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"Save"]}),(0,a.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>x(null),children:"Cancel"})]}):(0,a.jsxs)(a.Fragment,{children:["completed"!==e.status&&e.teamA&&e.teamB&&(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>G(e),disabled:o,children:[(0,a.jsx)(et.A,{className:"h-4 w-4 mr-2"}),"Import Game Data"]}),(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>_(e),disabled:!e.teamA||!e.teamB||o,children:[(0,a.jsx)(ea.A,{className:"h-4 w-4 mr-2"}),"completed"===e.status?"Edit Score":"Enter Score"]}),"completed"===e.status&&(0,a.jsxs)(Z,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsxs)(l.$,{size:"sm",variant:"destructive",disabled:o,children:[o?(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(er.A,{className:"h-4 w-4 mr-2"}),"Revert"]})}),(0,a.jsxs)(W,{children:[(0,a.jsxs)(Y,{children:[(0,a.jsx)(J,{children:"Revert Match?"}),(0,a.jsxs)(H,{children:["This will reset the score of the match between ",e.teamA.name," and ",e.teamB.name," to 0-0 and set its status back to pending. This allows captains to manage it again. Are you sure?"]})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(X,{children:"Cancel"}),(0,a.jsx)(q,{onClick:()=>I(e.id),children:"Confirm Revert"})]})]})]})]})]})})]},e.id)},U=t.filter(e=>"completed"!==e.status&&e.teamA&&e.teamB),L=t.filter(e=>"completed"===e.status);return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(eu,{isOpen:j,onClose:()=>v(!1),match:g,onImportSuccess:()=>{v(!1),N(null)}}),(0,a.jsx)(ed,{isOpen:b,onClose:()=>w(!1),games:C,onDelete:M}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Group Stage Management"}),(0,a.jsx)(m.BT,{children:"Administrative tools for managing group stage standings and calculations."})]}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)(l.$,{onClick:F,disabled:B,variant:"outline",className:"flex items-center gap-2",children:[B?(0,a.jsx)(c.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(er.A,{className:"h-4 w-4"}),B?"Recalculating...":"Recalculate Group Standings"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground self-center",children:"Use this button to manually recalculate all group standings based on completed matches."})]})})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Pending Matches"}),(0,a.jsx)(m.BT,{children:"Matches that are waiting for a result to be entered."})]}),(0,a.jsx)(m.Wu,{children:U.length>0?(0,a.jsxs)(ee.XI,{children:[(0,a.jsx)(ee.A0,{children:(0,a.jsxs)(ee.Hj,{children:[(0,a.jsx)(ee.nd,{children:"Group"}),(0,a.jsx)(ee.nd,{children:"Team A"}),(0,a.jsx)(ee.nd,{children:"Team B"}),(0,a.jsx)(ee.nd,{className:"text-center",children:"Score"}),(0,a.jsx)(ee.nd,{className:"text-right",children:"Action"})]})}),(0,a.jsx)(ee.BF,{children:U.map(P)})]}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-10",children:[(0,a.jsx)(en.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("p",{className:"mt-4",children:"No matches are currently pending."})]})})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Completed Matches"}),(0,a.jsx)(m.BT,{children:"Recently completed matches. You can edit the scores or revert the match to a pending state."})]}),(0,a.jsx)(m.Wu,{children:L.length>0?(0,a.jsxs)(ee.XI,{children:[(0,a.jsx)(ee.A0,{children:(0,a.jsxs)(ee.Hj,{children:[(0,a.jsx)(ee.nd,{children:"Group"}),(0,a.jsx)(ee.nd,{children:"Team A"}),(0,a.jsx)(ee.nd,{children:"Team B"}),(0,a.jsx)(ee.nd,{className:"text-center",children:"Final Score"}),(0,a.jsx)(ee.nd,{className:"text-right",children:"Action"})]})}),(0,a.jsx)(ee.BF,{children:L.map(P)})]}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-10",children:[(0,a.jsx)(ei.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("p",{className:"mt-4",children:"No matches have been completed yet."})]})})]})]})}var ex=t(26126),ep=t(50286),ef=t(85268),ej=t(81008);function ev(){let{toast:e}=(0,y.dj)(),{user:s}=(0,n.A)(),[t,i]=r.useState([]),[d,o]=r.useState(!0),[u,h]=r.useState(null);r.useEffect(()=>{!async function(){try{let e=await (0,el.Xe)();i(e.sort((e,s)=>e.group_id&&s.group_id?e.group_id.localeCompare(s.group_id):e.group_id&&!s.group_id?-1:!e.group_id&&s.group_id?1:e.playoff_round&&s.playoff_round?e.playoff_round-s.playoff_round:0))}catch(s){console.error("Error fetching matches:",s),e({title:"Error",description:"Failed to load matches.",variant:"destructive"})}finally{o(!1)}}()},[e]);let x=async(t,a)=>{if(!s){e({title:"Authentication Error",description:"You must be logged in to perform this action.",variant:"destructive"});return}h(t);try{let r=await s.getIdToken(),n=await fetch("/api/admin/updateMatchFormat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({matchId:t,seriesFormat:a})}),l=await n.json();if(l.success)i(e=>e.map(e=>e.id===t?{...e,series_format:a}:e)),e({title:"Success!",description:"Match format updated to ".concat(a.toUpperCase(),".")});else throw Error(l.message||"Failed to update match format")}catch(s){console.error("Failed to update match format:",s),e({title:"Error",description:"Could not update the match format. Please try again.",variant:"destructive"})}finally{h(null)}},p=async()=>{if(!s){e({title:"Authentication Error",description:"You must be logged in to perform this action.",variant:"destructive"});return}try{await s.getIdToken();let a=t.filter(e=>e.group_id);for(let e of a)"bo2"!==e.series_format&&await x(e.id,"bo2");e({title:"Success!",description:"Set ".concat(a.length," group stage matches to BO2 format.")})}catch(s){console.error("Failed to set group stage formats:",s),e({title:"Error",description:"Could not update group stage formats. Please try again.",variant:"destructive"})}},f=e=>e.group_id?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ep.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Group ",e.group_id.replace(/-/g," ").replace(/\w/g,e=>e.toUpperCase())]})]}):e.playoff_round?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ef.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Playoffs Round ",e.playoff_round]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Exhibition"})]}),j=e=>{switch(e){case"completed":return(0,a.jsx)(ex.E,{variant:"default",children:"Completed"});case"live":return(0,a.jsx)(ex.E,{variant:"destructive",children:"Live"});default:return(0,a.jsx)(ex.E,{variant:"outline",children:"Scheduled"})}},g=e=>{if(!e)return(0,a.jsx)(ex.E,{variant:"outline",children:"Not Set"});let s=e.toUpperCase(),t="bo2"===e?"secondary":"bo3"===e?"default":"destructive";return(0,a.jsx)(ex.E,{variant:t,children:s})};return d?(0,a.jsxs)("div",{className:"flex items-center justify-center py-10",children:[(0,a.jsx)(c.A,{className:"h-8 w-8 animate-spin"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading matches..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(ej.A,{className:"h-5 w-5"}),"Match Format Management"]}),(0,a.jsx)(m.BT,{children:"Set series formats for tournament matches. Group stage matches should be BO2, while playoff matches can be BO3 or BO5."})]}),(0,a.jsxs)(m.Wu,{children:[(0,a.jsx)("div",{className:"flex gap-4 mb-6",children:(0,a.jsxs)(l.$,{onClick:p,variant:"outline",children:[(0,a.jsx)(ep.A,{className:"h-4 w-4 mr-2"}),"Set All Group Matches to BO2"]})}),t.length>0?(0,a.jsxs)(ee.XI,{children:[(0,a.jsx)(ee.A0,{children:(0,a.jsxs)(ee.Hj,{children:[(0,a.jsx)(ee.nd,{children:"Match Type"}),(0,a.jsx)(ee.nd,{children:"Teams"}),(0,a.jsx)(ee.nd,{children:"Status"}),(0,a.jsx)(ee.nd,{children:"Score"}),(0,a.jsx)(ee.nd,{children:"Current Format"}),(0,a.jsx)(ee.nd,{children:"Set Format"})]})}),(0,a.jsx)(ee.BF,{children:t.map(e=>{var s,t,r,n;return(0,a.jsxs)(ee.Hj,{children:[(0,a.jsx)(ee.nA,{children:f(e)}),(0,a.jsx)(ee.nA,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"font-medium",children:(null===(s=e.teamA)||void 0===s?void 0:s.name)||"TBD"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"vs"}),(0,a.jsx)("div",{className:"font-medium",children:(null===(t=e.teamB)||void 0===t?void 0:t.name)||"TBD"})]})}),(0,a.jsx)(ee.nA,{children:j(e.status)}),(0,a.jsx)(ee.nA,{children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{className:"font-mono",children:[(null===(r=e.teamA)||void 0===r?void 0:r.score)||0," - ",(null===(n=e.teamB)||void 0===n?void 0:n.score)||0]})})}),(0,a.jsx)(ee.nA,{children:g(e.series_format)}),(0,a.jsxs)(ee.nA,{children:[(0,a.jsxs)(em.l6,{value:e.series_format||"",onValueChange:s=>x(e.id,s),disabled:u===e.id,children:[(0,a.jsx)(em.bq,{className:"w-20",children:(0,a.jsx)(em.yv,{placeholder:"Format"})}),(0,a.jsxs)(em.gC,{children:[(0,a.jsx)(em.eb,{value:"bo1",children:"BO1"}),(0,a.jsx)(em.eb,{value:"bo2",children:"BO2"}),(0,a.jsx)(em.eb,{value:"bo3",children:"BO3"}),(0,a.jsx)(em.eb,{value:"bo5",children:"BO5"})]})]}),u===e.id&&(0,a.jsx)(c.A,{className:"h-4 w-4 animate-spin ml-2"})]})]},e.id)})})]}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-10",children:[(0,a.jsx)(v.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("p",{className:"mt-4",children:"No matches found."})]})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsx)(m.ZB,{children:"Format Guidelines & Scoring"})}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ex.E,{variant:"secondary",children:"BO2"}),(0,a.jsx)("span",{children:"Best of 2 - Used for group stage matches. Can end in draws (1-1)."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ex.E,{variant:"default",children:"BO3"}),(0,a.jsx)("span",{children:"Best of 3 - First to win 2 games. Common for playoff matches."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ex.E,{variant:"destructive",children:"BO5"}),(0,a.jsx)("span",{children:"Best of 5 - First to win 3 games. Used for finals and important matches."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ex.E,{variant:"outline",children:"BO1"}),(0,a.jsx)("span",{children:"Best of 1 - Single game only. Quick elimination format."})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-3",children:"Group Stage Scoring (BO2 matches):"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Win 2-0:"}),(0,a.jsx)("span",{className:"font-mono",children:"2 points"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Draw 1-1:"}),(0,a.jsx)("span",{className:"font-mono",children:"1 point each"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Loss 0-2:"}),(0,a.jsx)("span",{className:"font-mono",children:"0 points"})]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Points are awarded based on individual games won, not matches won."})]})]})})]})]})}var eg=t(10549),eN=t(76570),eb=t(36338);let ey=(0,A.createServerReference)("708172d6c43d2a2bbe96dedc63e79cc5bac3188311",A.callServer,void 0,A.findSourceMapURL,"updateTeamStatus"),ew=(0,A.createServerReference)("6090a0b4fd650e83ddbf9c3bb66c11e1c7166f2f74",A.callServer,void 0,A.findSourceMapURL,"deleteTeam");function eS(e){let{isOpen:s,onClose:t,imageUrl:r,title:n="Screenshot"}=e;return s?(0,a.jsx)(D.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(D.Cf,{className:"max-w-4xl",children:[(0,a.jsx)(D.c7,{children:(0,a.jsx)(D.L3,{children:n})}),(0,a.jsx)("div",{className:"mt-4 relative h-[70vh]",children:(0,a.jsx)(eo.default,{src:r,alt:n,layout:"fill",objectFit:"contain"})})]})}):null}function eA(e){var s;let{team:t,onStatusUpdate:r,onDelete:n,isUpdating:i,onPlayerClick:d}=e;return(0,a.jsx)(eg.AccordionContent,{children:(0,a.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Roster:"}),(0,a.jsx)("ul",{className:"space-y-1 list-disc list-inside",children:null===(s=t.players)||void 0===s?void 0:s.map((e,s)=>(0,a.jsxs)("li",{onClick:()=>d(e),className:"cursor-pointer hover:text-primary",children:[e.nickname," - ",(0,a.jsxs)("span",{className:"font-mono",children:[e.mmr," MMR"]})]},"".concat(t.id,"-").concat(e.id||e.nickname||s)))}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,a.jsxs)(l.$,{size:"sm",variant:"secondary",onClick:()=>r(t.id,"verified"),disabled:i,children:[(0,a.jsx)(eN.A,{className:"h-4 w-4 mr-2"})," Verify"]}),(0,a.jsxs)(l.$,{size:"sm",variant:"default",onClick:()=>r(t.id,"warning"),disabled:i,children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-2"})," Issue Warning"]}),(0,a.jsxs)(l.$,{size:"sm",variant:"destructive",onClick:()=>r(t.id,"rejected"),disabled:i,children:[(0,a.jsx)(eb.A,{className:"h-4 w-4 mr-2"})," Reject"]}),(0,a.jsxs)(l.$,{size:"sm",variant:"destructive",onClick:()=>r(t.id,"banned"),disabled:i,children:[(0,a.jsx)(eb.A,{className:"h-4 w-4 mr-2"})," Ban"]}),(0,a.jsxs)(Z,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsx)(l.$,{size:"sm",variant:"destructive",disabled:i,children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(W,{children:[(0,a.jsxs)(Y,{children:[(0,a.jsx)(J,{children:"Are you absolutely sure?"}),(0,a.jsx)(H,{children:"This action cannot be undone. This will permanently delete the team and all of its data from our servers."})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(X,{children:"Cancel"}),(0,a.jsxs)(q,{onClick:()=>n(t.id),children:[i?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Delete"]})]})]})]})]})]})})}function eC(){let{user:e}=(0,n.A)(),[s,t]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[d,o]=(0,r.useTransition)(),{toast:u}=(0,y.dj)(),[h,x]=(0,r.useState)(!1),[p,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{!async function(){l(!0);let[e,s]=await Promise.all([(0,S.Z)(),(0,el.oy)()]),a={};e.forEach(e=>a[e.id]=0),s.forEach(e=>{e.scores&&Object.entries(e.scores).forEach(e=>{let[s,t]=e;void 0!==a[s]&&(a[s]+=t)})}),t(e.map(e=>({...e,communityScore:a[e.id]||0})).sort((e,s)=>s.communityScore-e.communityScore)),l(!1)}()},[]);let j=e=>{f(e),x(!0)},v=(s,a)=>{o(async()=>{if(!e){u({title:"Authentication Error",description:"You must be logged in to perform this action.",variant:"destructive"});return}try{let r=await e.getIdToken(),n=await ey(r,s,a);(null==n?void 0:n.success)?(t(e=>e.map(e=>e.id===s?{...e,status:a}:e)),u({title:"Success!",description:"Team status has been updated to ".concat(a,".")})):u({title:"Update Failed",description:(null==n?void 0:n.error)||"An unknown error occurred.",variant:"destructive"})}catch(e){u({title:"An Unexpected Error Occurred",description:e.message||"Please try again later.",variant:"destructive"})}})},g=s=>{o(async()=>{if(!e){u({title:"Authentication Error",description:"You must be logged in to perform this action.",variant:"destructive"});return}let a=await e.getIdToken(),r=await ew(a,s);r.success?(t(e=>e.filter(e=>e.id!==s)),u({title:"Success!",description:"Team has been deleted."})):u({title:"Error",description:r.message,variant:"destructive"})})},N=e=>{switch(e){case"verified":return"secondary";case"warning":return"default";case"banned":case"rejected":return"destructive";default:return"outline"}};return i?(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsx)(m.ZB,{children:"Team Verification"})}),(0,a.jsx)(m.Wu,{className:"flex justify-center items-center h-48",children:(0,a.jsx)(c.A,{className:"h-16 w-16 animate-spin"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Team Verification"}),(0,a.jsx)(m.BT,{children:"Review and verify team rosters and player eligibility."})]}),(0,a.jsx)(m.Wu,{children:(0,a.jsx)(eg.Accordion,{type:"single",collapsible:!0,className:"w-full",children:s.map(e=>{var s;return(0,a.jsxs)(eg.AccordionItem,{value:e.id,children:[(0,a.jsx)(eg.AccordionTrigger,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-4 w-full mr-4",children:[(0,a.jsx)(eo.default,{src:e.logoUrl||"/backgrounds/liga_fantasy.png",alt:e.name,width:40,height:40,className:"rounded-md"}),(0,a.jsxs)("div",{className:"flex-grow text-left",children:[(0,a.jsxs)("p",{className:"font-bold text-lg",children:[e.name," ",(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",e.tag,")"]})]}),(0,a.jsxs)("p",{className:"text-sm",children:["Total MMR: ",(null===(s=e.players)||void 0===s?void 0:s.reduce((e,s)=>e+s.mmr,0))||"N/A"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Community Score"}),(0,a.jsx)("p",{className:"text-lg font-bold text-primary",children:e.communityScore})]}),(0,a.jsx)(ex.E,{variant:N(e.status),className:"ml-auto",children:e.status||"Pending"})]})}),(0,a.jsx)(eA,{team:e,onStatusUpdate:v,onDelete:g,isUpdating:d,onPlayerClick:j})]},e.id)})})})]}),p&&(0,a.jsx)(eS,{isOpen:h,onClose:()=>x(!1),imageUrl:p.profileScreenshotUrl,title:"MMR Proof for ".concat(p.nickname)})]})}let eT=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,w.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})});eT.displayName="Textarea";var eB=t(87120);let ek=(0,A.createServerReference)("702c4c9a7b8f7c073c5908fb0bc2f9bc10d3c583df",A.callServer,void 0,A.findSourceMapURL,"createAnnouncement"),eR=(0,A.createServerReference)("6078fcacdabb48bd18a38ea5d6e005ca43aeaddd65",A.callServer,void 0,A.findSourceMapURL,"deleteAnnouncement");var eE=t(35095);function eM(){let{user:e}=(0,n.A)(),[s,t]=(0,r.useState)(""),[i,d]=(0,r.useState)(""),[o,h]=(0,r.useState)([]),[x,p]=(0,r.useTransition)(),[f,j]=(0,r.useState)(!0),{toast:v}=(0,y.dj)(),g=(0,r.useMemo)(()=>[...o].sort((e,s)=>s.createdAt.getTime()-e.createdAt.getTime()),[o]),b=async()=>{j(!0),h(await (0,el.jP)()),j(!1)};(0,r.useEffect)(()=>{b()},[]);let w=async()=>{if(!e){v({title:"Not Authenticated",description:"You must be logged in to post an announcement.",variant:"destructive"});return}if(!s.trim()||!i.trim()){v({title:"Error",description:"Title and content cannot be empty.",variant:"destructive"});return}p(async()=>{let a=await e.getIdToken(),r=await ek(a,s,i);r.success?(t(""),d(""),await b(),v({title:"Success!",description:"Your announcement has been posted."})):(console.error("Failed to create announcement:",r.error),v({title:"Error",description:"Could not post the announcement. Please try again.",variant:"destructive"}))})},S=async s=>{if(!e){v({title:"Not Authenticated",description:"You must be logged in to delete an announcement.",variant:"destructive"});return}p(async()=>{let t=await e.getIdToken(),a=await eR(t,s);a.success?(await b(),v({title:"Deleted",description:"The announcement has been removed."})):(console.error("Failed to delete announcement:",a.error),v({title:"Error",description:"Could not delete the announcement. Please try again.",variant:"destructive"}))})};return(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Manage Announcements"}),(0,a.jsx)(m.BT,{children:"Post new announcements or delete existing ones."})]}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Create New Announcement"}),(0,a.jsx)(u.p,{placeholder:"Announcement Title",value:s,onChange:e=>t(e.target.value),disabled:x}),(0,a.jsx)(eT,{placeholder:"Type your announcement here...",value:i,onChange:e=>d(e.target.value),rows:4,disabled:x}),(0,a.jsxs)(l.$,{onClick:w,disabled:x||!e,className:"mt-2",children:[x?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(eB.A,{className:"mr-2 h-4 w-4"}),x?"Posting...":"Post Announcement"]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Existing Announcements"}),f?(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(c.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsx)("ul",{className:"space-y-2",children:g.map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold",children:e.title}),(0,a.jsx)("p",{children:e.content}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Posted ",(0,eE.m)(new Date(e.createdAt),{addSuffix:!0})," by ",e.authorName]})]}),(0,a.jsx)(l.$,{size:"sm",variant:"destructive",onClick:()=>S(e.id),disabled:x,children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]},e.id))})]})]})]})}var eF=t(47262),eD=t(66424),eI=t(19050);let eO=(0,A.createServerReference)("607ce3139391a6a7994106439efac734b8217ccdf3",A.callServer,void 0,A.findSourceMapURL,"deleteSelectedMatches"),e_=(0,A.createServerReference)("40172953312df4b0529719f46107134298feff3b7a",A.callServer,void 0,A.findSourceMapURL,"deleteAllMatches");var eG=t(34301),eP=t(67554),eU=t(5363),eZ=t(28292);let e$=(0,A.createServerReference)("40bb76aed8d78b6714aa7b986666bf2584aca6907d",A.callServer,void 0,A.findSourceMapURL,"createFakeTeamServerAction");function eL(e){let{onTeamCreated:s}=e,[t,n]=r.useState(!1),{toast:i}=(0,y.dj)(),d=async()=>{n(!0);let e=await e$(!0);e.success?(i({title:"Success!",description:e.message,variant:"default"}),s()):i({title:"Oh no!",description:e.message,variant:"destructive"}),n(!1)};return(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Test Data Generation"}),(0,a.jsx)(m.BT,{children:"Create mock data for testing purposes."})]}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)(l.$,{onClick:d,disabled:t,children:[t?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(eG.A,{className:"mr-2 h-4 w-4"}),t?"Creating Test Team...":"Create Test Team"]})})]})}function ez(){let[e,s]=r.useState(!1),[t,i]=r.useState(!1),[d,o]=r.useState(!1),[u,h]=r.useState(!1),[x,p]=r.useState(!1),[f,j]=r.useState(""),[v,g]=r.useState([]),[w,S]=r.useState([]),{toast:A}=(0,y.dj)(),{user:C}=(0,n.A)(),T=r.useRef(null),B=r.useCallback(async()=>{g(await (0,el.Xe)())},[]);r.useEffect(()=>{B()},[B]);let k=async()=>{s(!0);try{let e=await fetch("/api/admin-sync-matches",{method:"POST"}),s=await e.json();A({title:s.success?"Success!":"Sync Failed",description:s.message,variant:s.success?"default":"destructive"})}catch(e){A({title:"Sync Failed",description:"Network or server error.",variant:"destructive"})}s(!1),B()},R=async()=>{h(!0);try{let e=await fetch("/api/debug/clear-processed",{method:"POST"}),s=await e.json();A({title:s.success?"Success!":"Clear Failed",description:s.success?s.message:s.error,variant:s.success?"default":"destructive"})}catch(e){A({title:"Clear Failed",description:"Network or server error.",variant:"destructive"})}h(!1)},E=async()=>{p(!0);try{let e=await fetch("/api/admin/update-team-stats",{method:"POST"}),s=await e.json();A({title:s.success?"Success!":"Update Failed",description:s.success?s.message:s.error,variant:s.success?"default":"destructive"})}catch(e){A({title:"Update Failed",description:"Network or server error.",variant:"destructive"})}p(!1)},M=async()=>{if(!f||isNaN(Number(f))){A({title:"Invalid Match ID",description:"Please enter a numeric OpenDota match ID.",variant:"destructive"});return}i(!0);let e=await (0,eI.Jt)(Number(f),f);A({title:e.success?"Success!":"Import Failed",description:e.message,variant:e.success?"default":"destructive"}),i(!1),B()},F=async()=>{if(!C){A({title:"Authentication Error",description:"You must be logged in to delete matches.",variant:"destructive"});return}let e=await C.getIdToken();o(!0);let s=await eO(e,w);A({title:s.success?"Success!":"Deletion Failed",description:s.message,variant:s.success?"default":"destructive"}),S([]),o(!1),B()},D=async()=>{if(!C){A({title:"Authentication Error",description:"You must be logged in to delete matches.",variant:"destructive"});return}let e=await C.getIdToken();o(!0);let s=await e_(e);A({title:s.success?"Success!":"Deletion Failed",description:s.message,variant:s.success?"default":"destructive"}),o(!1),B()},I=e=>{S(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Advanced Tools"}),(0,a.jsx)(m.BT,{children:"Use these tools for testing, data management, and test account administration."})]}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsx)(eL,{onTeamCreated:()=>{T.current&&T.current.refreshTeams()}}),(0,a.jsx)(eZ.y,{ref:T}),(0,a.jsx)(eU.$,{}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsx)(m.ZB,{children:"OpenDota Integration"})}),(0,a.jsxs)(m.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("input",{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Enter OpenDota Match ID",className:"p-2 border rounded-md w-full"}),(0,a.jsxs)(l.$,{onClick:M,disabled:t,children:[t?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(eG.A,{className:"mr-2 h-4 w-4"}),t?"Importing...":"Import Match"]})]}),(0,a.jsxs)(l.$,{onClick:k,disabled:e,children:[e?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(eP.A,{className:"mr-2 h-4 w-4"}),e?"Syncing...":"Sync All New Matches"]}),(0,a.jsxs)(l.$,{onClick:R,disabled:u,variant:"destructive",children:[u?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),u?"Clearing...":"Clear Processed Games"]}),(0,a.jsxs)(l.$,{onClick:E,disabled:x,variant:"outline",children:[x?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(eP.A,{className:"mr-2 h-4 w-4"}),x?"Updating...":"Update Team Statistics"]})]})]}),(0,a.jsxs)("div",{className:"p-4 border border-destructive/50 rounded-lg bg-destructive/10",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-destructive mb-2 flex items-center",children:[(0,a.jsx)(b.A,{className:"mr-2 h-5 w-5"}),"Match Deletion Zone"]}),(0,a.jsx)(eD.F,{className:"h-72 w-full rounded-md border p-4 mb-4",children:(0,a.jsx)("div",{className:"space-y-2",children:v.map(e=>{var s,t;return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eF.S,{id:"match-".concat(e.id),onCheckedChange:()=>I(e.id),checked:w.includes(e.id)}),(0,a.jsxs)("label",{htmlFor:"match-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[(null===(s=e.teamA)||void 0===s?void 0:s.name)||"N/A"," vs ",(null===(t=e.teamB)||void 0===t?void 0:t.name)||"N/A"," ",(0,a.jsxs)("span",{className:"text-muted-foreground",children:["(ID: ",e.id,", Group: ",e.group_id||"N/A",")"]})]})]},e.id)})})}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(l.$,{variant:"destructive",onClick:F,disabled:d||0===w.length,children:[d?(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Delete Selected (",w.length,")"]}),(0,a.jsxs)(Z,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"destructive",disabled:d,children:"Delete All Matches"})}),(0,a.jsxs)(W,{children:[(0,a.jsxs)(Y,{children:[(0,a.jsx)(J,{children:"Are you absolutely sure?"}),(0,a.jsxs)(H,{children:["This will delete all ",v.length," matches. This is irreversible."]})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(X,{children:"Cancel"}),(0,a.jsx)(q,{onClick:D,children:"Yes, delete all"})]})]})]})]})]})]})]})}var eW=t(60704);let eY=eW.bL,eV=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eW.B8,{ref:s,className:(0,w.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});eV.displayName=eW.B8.displayName;let eJ=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eW.l9,{ref:s,className:(0,w.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});eJ.displayName=eW.l9.displayName;let eH=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eW.UC,{ref:s,className:(0,w.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});function eq(){let{user:e,signInWithGoogle:s}=(0,n.A)(),[t,u]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async function(){e&&u(await (0,i.n)(e)),x(!1)})()},[e]),h)?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(c.A,{className:"h-16 w-16 animate-spin"})}):e?t?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(m.Zp,{className:"shadow-xl",children:(0,a.jsxs)(m.aR,{className:"text-center",children:[(0,a.jsx)(o.A,{className:"h-16 w-16 mx-auto text-primary mb-4"}),(0,a.jsx)(m.ZB,{className:"text-4xl font-bold text-primary",children:"Admin Panel"}),(0,a.jsx)(m.BT,{className:"text-lg text-muted-foreground",children:"Manage the tournament, update standings, and verify teams."})]})}),(0,a.jsxs)(eY,{defaultValue:"stage",children:[(0,a.jsxs)(eV,{className:"grid w-full grid-cols-6",children:[(0,a.jsx)(eJ,{value:"stage",children:"Stage"}),(0,a.jsx)(eJ,{value:"standings",children:"Standings"}),(0,a.jsx)(eJ,{value:"matches",children:"Matches"}),(0,a.jsx)(eJ,{value:"teams",children:"Teams"}),(0,a.jsx)(eJ,{value:"announcements",children:"Announcements"}),(0,a.jsx)(eJ,{value:"advanced",children:"Advanced"})]}),(0,a.jsx)(eH,{value:"stage",children:(0,a.jsx)(Q,{})}),(0,a.jsx)(eH,{value:"standings",children:(0,a.jsx)(eh,{})}),(0,a.jsx)(eH,{value:"matches",children:(0,a.jsx)(ev,{})}),(0,a.jsx)(eH,{value:"teams",children:(0,a.jsx)(eC,{})}),(0,a.jsx)(eH,{value:"announcements",children:(0,a.jsx)(eM,{})}),(0,a.jsx)(eH,{value:"advanced",children:(0,a.jsx)(ez,{})})]})]}):(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-red-500",children:"Access Denied"}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground",children:"You do not have permission to view this page."})]}):(0,a.jsxs)(m.Zp,{className:"text-center max-w-md mx-auto mt-20",children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Admin Access Required"}),(0,a.jsx)(m.BT,{children:"Please log in to access the admin panel."})]}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)(l.$,{onClick:s,children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Sign in with Google"]})})]})}eH.displayName=eW.UC.displayName},79323:(e,s,t)=>{"use strict";async function a(e){if(!e)return!1;try{let s=await e.getIdToken(!0),t=await fetch("/api/checkAdmin",{method:"POST",headers:{Authorization:"Bearer ".concat(s)}});if(!t.ok){let e=await t.json();return console.error("Error from checkAdmin API:",e.error),!1}let a=await t.json();return!0===a.isAdmin}catch(e){return console.error("Error calling checkAdmin API route:",e),!1}}t.d(s,{n:()=>a})},85127:(e,s,t)=>{"use strict";t.d(s,{A0:()=>l,BF:()=>c,Hj:()=>d,XI:()=>i,nA:()=>m,nd:()=>o});var a=t(95155),r=t(12115),n=t(59434);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,n.cn)("w-full caption-bottom text-sm",t),...r})})});i.displayName="Table";let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("thead",{ref:s,className:(0,n.cn)("[&_tr]:border-b",t),...r})});l.displayName="TableHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...r})});c.displayName="TableBody",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{ref:s,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});d.displayName="TableRow";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("th",{ref:s,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r})});o.displayName="TableHead";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("td",{ref:s,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r})});m.displayName="TableCell",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("caption",{ref:s,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption"}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,7138,4277,2759,3063,6433,5725,1345,8034,3013,6298,287,3830,3858,9011,5168,9023,5334,8187,8441,1684,7358],()=>s(44829)),_N_E=e.O()}]);